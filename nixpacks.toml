[phases.setup]
# Install additional apt packages required for WeasyPrint
# Both runtime libraries and development packages are needed
aptPkgs = [
    "curl",
    "wget",
    "pkg-config",
    # Runtime libraries
    "libgobject-2.0-0",
    "libpango-1.0-0",
    "libpangocairo-1.0-0",
    "libcairo2",
    "libgdk-pixbuf2.0-0",
    "libffi-dev",
    "fonts-liberation",
    # Development packages (needed for CFFI to find libraries)
    "libglib2.0-dev",
    "libpango1.0-dev",
    "libcairo2-dev",
    "libgdk-pixbuf2.0-dev",
    # Additional dependencies
    "shared-mime-info",
    "libxml2",
    "libpangoft2-1.0-0"
]

# Set library path so Python can find the apt-installed libraries
[start]
cmd = "LD_LIBRARY_PATH=/usr/lib/x86_64-linux-gnu:$LD_LIBRARY_PATH uvicorn app.main:app --host 0.0.0.0 --port 8000 --workers 4"
